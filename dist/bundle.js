!function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=e(mapboxgl);const n="pk.eyJ1IjoiZGJhcm5lc2VuIiwiYSI6IjFWeUJFNFUifQ.CF2Du3MPcaCQhBBNJSQMDQ",l="https://uploads-ssl.webflow.com/5a12777c9048ed000106553e/65f40a4f33d817767e6e242e_marker_blue.svg",a=[8.2961,59.91639];function c(t){t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}let r,i=[];function s(){console.log("Setting up markers..."),i.forEach((t=>t.remove())),i=[],document.querySelectorAll(".tur-collection-item").forEach((t=>{const e=parseFloat(t.getAttribute("data-lat")),n=parseFloat(t.getAttribute("data-lg")),a=t.getAttribute("data-kategori");if(!isNaN(e)&&!isNaN(n)){const s=function(t=l){const e=document.createElement("div");return e.className="custom-marker",e.style.backgroundImage=`url(${t})`,e.style.width="40px",e.style.height="50px",e.style.backgroundSize="cover",e}(l),u=new o.default.Marker({element:s,anchor:"bottom"}).setLngLat([n,e]).addTo(r);i.push({marker:u,category:a,item:t}),t.addEventListener("click",(()=>{var e;console.log(`Collection item clicked, category: ${a}`),c&&c(t),e=t,console.log(`Toggling collection content for: ${e.getAttribute("data-item-id")}`),content!==currentlyOpenContent?(currentlyOpenContent&&d(currentlyOpenContent),function(t){t.style.display="block",setTimeout((()=>{t.classList.add("expanded"),t.style.height="30vh"}),10)}(content),currentlyOpenContent=content):(d(content),currentlyOpenContent=null)})),u.getElement().addEventListener("click",(()=>{console.log("Marker clicked, simulating item click."),t.click()}))}}))}function d(t){t.classList.remove("expanded"),setTimeout((()=>{t.style.height="0",setTimeout((()=>t.style.display="none"),300)}),10)}document.querySelectorAll(".showmapbutton").forEach((t=>{t.addEventListener("click",(function(){const t=this.getAttribute("data-kategori"),e=this.getAttribute("data-mapstyle")||"default_map_style";console.log(`Showmapbutton clicked, category: ${t}, mapStyle: ${e}`),function(t,e,l){r?r.getStyle().styleURL!==t&&(console.log("Updating map style to:",t),r.setStyle(t).on("style.load",(()=>{s()}))):(console.log("Initializing map for the first time with style:",t),o.default.accessToken=n,r=new o.default.Map({container:"turmap",style:t,center:a,zoom:5.5}),r.on("load",(()=>{s()})))}(e),function(t){console.log(`Applying filters for category: ${t}`),document.querySelectorAll(".tur-collection-item").forEach((e=>{e.style.display=e.getAttribute("data-kategori")===t?"block":"none"})),function(t){console.log(`Filtering markers for category: ${t}`);const e=new o.default.LngLatBounds;i.forEach((({marker:o,item:n})=>{const l=n.getAttribute("data-kategori")===t;o.getElement().style.visibility=l?"visible":"hidden",l?(o.addTo(r),e.extend(o.getLngLat())):o.remove()})),e.isEmpty()||(console.log("Adjusting map view to fit markers."),r.fitBounds(e,{padding:50,duration:5e3}))}(t)}(t)}))}));function u(){let t,e;const o=e=>{t=e.touches[0].clientY},n=o=>{if(!t)return;e=o.changedTouches[0].clientY;const n=e-t;Math.abs(n)>20&&(n>0?a(o.target):l(o.target),window.scrollTo(0,0),t=null)},l=t=>{const e=t.closest(".tur-collection-content");if(e){e.style.height="70vh",e.classList.add("expanded");const t=e.querySelector(".tur-tray-arrow");t&&(t.style.transform="rotateX(0deg)")}},a=t=>{const e=t.closest(".tur-collection-content");if(e){e.classList.remove("expanded"),e.style.height="20vh",setTimeout((()=>{e.classList.contains("expanded")||(e.style.display="none")}),300);const t=e.querySelector(".tur-tray-arrow");t&&(t.style.transform="rotateX(180deg)")}};var c,r;c=".tur-content-slide-cnt",r=t=>{t.addEventListener("touchstart",o),t.addEventListener("touchend",n)},document.querySelectorAll(c).forEach(r)}document.addEventListener("DOMContentLoaded",(()=>{mapboxgl.accessToken=n,function(){o.default.accessToken=n;const t=new o.default.Map({container:"turmap",style:"mapbox://styles/dbarnesen/ckk3vfvbi4t1v17p82fuy61pt",center:a,zoom:5.5,pitch:54});t.addControl(new o.default.NavigationControl,"top-right"),t.addControl(new o.default.ScaleControl({maxWidth:80,unit:"metric"}));const e=new o.default.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserLocation:!0,showUserHeading:!0});t.on("load",(()=>t.addControl(e))),document.getElementById("geolocateButton").addEventListener("click",(()=>e.trigger()))}(),s(),u()}))}();
